#!/usr/bin/env bash

command cd $HOME
_xdg_config_home=${XDG_CONFIG_HOME:-$HOME/.config}
_xdg_data_home=${XDG_DATA_HOME:-$HOME/.local/share}

ln -svTf ${_xdg_config_home}/dotfiles{-priv,}/bash/work
ln -svTf ${_xdg_config_home}/dotfiles{-priv,}/emacs.d/work.el
ln -svTf ${_xdg_config_home}/dotfiles{-priv,}/scripts/amd
ln -svTf ${_xdg_config_home}/dotfiles{-priv,}/vim/pack/rc_local

mkdir -p ${_xdg_config_home}{,/git}
ln -svTf ${_xdg_config_home}/dotfiles     ~/.dotfiles
ln -svTf ${_xdg_config_home}/dotfiles/bash/bashrc           ~/.bashrc
ln -svTf ${_xdg_config_home}/dotfiles/ctags                 ~/.ctags
ln -svTf ${_xdg_config_home}/dotfiles/vim                   ~/.config/nvim
ln -svTf ${_xdg_config_home}/dotfiles/vim                   ~/.vim
ln -svTf ${_xdg_config_home}/dotfiles/xinitrc               ~/.xinitrc
ln -svTf ${_xdg_config_home}/dotfiles/Xresources            ~/.Xresources
ln -svTf ${_xdg_config_home}/dotfiles/fzf/fzf.bash          ~/.fzf.bash
# ln -svTf ${_xdg_config_home}/dotfiles/awesome             ~/.config/awesome
# ln -svTf ${_xdg_config_home}/dotfiles/i3                  ~/.config/i3

mkdir -p ${_xdg_config_home}/git
ln -svTf ${_xdg_config_home}/dotfiles/gitignore             ${_xdg_config_home}/git/ignore

mkdir -p ~/.ssh
ln -svTf ${_xdg_config_home}/dotfiles/ssh/config            ~/.ssh/config

mkdir -p ~/.unison
ln -svTf ~${_xdg_config_home}/dotfiles/unison/dotfiles.prf  ~/.unison/dotfiles.prf

mkdir -p ~/bin
ln -svTf ${_xdg_config_home}/dotfiles/scripts/vim_merge     ~/bin/vim_merge
ln -svTf ${_xdg_config_home}/dotfiles/scripts/emacs_daemon  ~/bin/emacs_daemon
# ln -svTf ${_xdg_config_home}/dotfiles/scripts/wim         ~/bin/vim

mkdir -p ${_xdg_data_home}{,/bash_history}
command rm -i ~/.bash_history 2> /dev/null

# Create a pipe. Woo!
if [[ ! -p ~/pipe ]]; then
  mkfifo ~/pipe
fi
